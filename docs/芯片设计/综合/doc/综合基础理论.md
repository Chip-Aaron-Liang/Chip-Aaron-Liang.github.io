---
tags:
  - 芯片设计
  - 综合
---
#  综合流程

## 总览

1. `Translation`：将RTL映射为通用单元，如将时许逻辑翻译成触发器等。该步骤需要指定通用单元库，该单元库与Foundry和工艺无关。
2. `Mapping&Optimization`：将通用单元映射到标准单元库，并进行优化。该步骤与不同Foundry、不同工艺下的元器件有关，例如同样是与门，有的Foundry可能有三输入与门，有的Foundry可能没有三输入与门，同样的组合逻辑a&b&c在不同Foundry条件下映射出来的电路完全不同。

## 详细流程

### **一、预综合准备**

1. **库文件配置**
    - **目标库（`target_library`）**：指定映射到工艺库的标准单元（如`.db`文件），通常选择最恶劣工艺角以确保时序收敛[[DC综合环境搭建#^target-library|-->脚本命令举例]]
    - **链接库（`link_library`）**：指定了DC在链接阶段搜索工艺库和其他参考库的路径包含所有引用模块（如IP核、内存编译器输出），需添加`*`符号优先搜索内存中的库[[DC综合环境搭建#^link-library|-->脚本命令举例]]
    - **符号库（`symbol_library`）**：用于图形化查看综合结果（如Design Vision界面）
    - **综合库（`synthetic_library`）**：包含逻辑优化所需的算术单元（如加法器、乘法器）模型[[DC综合环境搭建#^synthetic-library|-->脚本命令举例]]
2. **环境配置文件**  
    在`.synopsys_dc.setup`中设置搜索路径（`search_path`）和库文件路径，确保DC能正确加载工艺库和设计文件[[DC综合环境搭建#^search-path|-->脚本命令举例]]

---

### **二、设计读取与链接**

1. **读取RTL代码**
    - 使用`read_verilog`或`read_vhdl`命令加载设计文件，DC将其转换为工艺无关的中间格式（GTECH库）
    - 若设计包含宏单元（如RAM），需通过`read_db`或`read_library`加载预编译库
    - `analyze`：语法检查并生成中间文件（`.syn`），存储于`work`目录[[DC综合环境搭建#^analyze|-->脚本命令举例]]
    - `elaborate`：基于中间文件构建设计层次，转换为GTECH格式[[DC综合环境搭建#^elaborate|-->脚本命令举例]]
2. **链接与设计检查**
    - 执行`link`命令解析模块层级和未解析引用，确保所有实例化单元在`link_library`中存在
    - 使用`check_design`验证设计完整性，修复语法错误或未连接的端口

---

### **三、约束设置**

1. **时序约束**
    - **创建时钟**：`create_clock -period 10 [get_ports clk]`定义主时钟周期
    - **输入/输出延迟**：`set_input_delay`和`set_output_delay`约束接口时序，考虑外部逻辑延迟
    - **时钟不确定性**：`set_clock_uncertainty`模拟时钟抖动和偏斜
2. **环境与面积约束**
    - **驱动强度与负载**：`set_driving_cell`定义输入端口驱动能力，`set_load`设置输出端口负载电容
    - **工作条件**：`set_operating_conditions`指定工艺、电压和温度场景（如`slow_125`）
    - **面积限制**：`set_max_area`控制设计面积上限

---

### **四、综合优化**

1. **逻辑综合命令**
    - **基础优化**：`compile`命令执行默认优化（翻译+逻辑优化+映射）
    - **高级优化**：`compile_ultra`（拓扑模式）启用以时序驱动的高级优化，如算术单元选择、逻辑复制和自动取消模块划分。[[DC综合环境搭建#^complie|-->脚本命令举例]]
2. **分层次优化策略**
    - **结构级优化**：共享子表达式、数据通路优化（如CSA算法）
    - **逻辑级优化**：展平或结构化逻辑，减少逻辑级数
    - **门级优化**：调整标准单元选择，插入缓冲器平衡时序

---

### **五、验证与输出**

1. **时序与功能验证**
    - **报告生成**：`report_timing`检查关键路径时序，`report_constraint`验证约束满足度
    - **形式验证**：使用Formality对比综合前后的功能一致性。
2. **网表输出**
    - **门级网表**：`write_file -format verilog`生成`.v`文件，`write_sdf`输出时序延迟文件
    - **物理信息整合**：在拓扑模式下结合Floorplan数据，优化布局相关时序



## 关于内存管理
- 若使用`analyze`命令，生成的中间文件（`.syn`）默认保存在本地`work`目录，但实际设计对象（如模块、端口）仍驻留内存供后续操作调用
- 在`link_library`设置中包含`*`符号时，DC会优先从内存中已加载的模块或单元电路中解析引用，再搜索外部库路径。这表明内存中保留了设计实例的缓存
- 当设计包含大量内存密集型模块（如RAM/ROM）时，直接综合可能导致内存不足。此时需使用Memory Compiler生成库文件（`.lib`或`.db`），并在DC中作为工艺库引用，减少内存占用

## 关于Uniquify解释
C语言中的函数：它存储在同一个内存位置，多次调用以为着多次进入这块内存区域运行，因此，C语言多次调用同一个函数比不使用函数更节省内存。

---

RTL中同一个模块多次例化则是多次复制，并不能节省面积。对同一模块的不同例化，区分方法是路径+例化名。但综合工具可能会对RTL层次化打平，所以如果两个例化实例路径不同但实例话名相同时，可能出现错误。所以使用Uniquify将例化名进行复制，保证整个RTL中每个模块名不同。

## db文件与lib文件
DC工具需要的都是二进制文件`.db`，而某些情况下PDK目录中没有相应的`.db`文件，如某些rom和mem compiler生成的为`.lib`文件，需要用户使用Library Compiler将`.lib`文件转换成`.db`文件。
1. 启动Library Compiler
```shell
lc_shell
```
2. 读取lib库，提示`Technology library 'xxx' read successfully`
```shell
read_lib rom_tt.lib
```
3. 转换lib库到db库
```shell
write_lib -format db -out rom_tt.db
```