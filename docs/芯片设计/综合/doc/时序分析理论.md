---
tags:
  - 芯片设计
  - 综合
---
# 时序理论
数字设计中的延迟路径如下图，路径1为输入端口到寄存器端口，路径2为寄存器到寄存器，路径3为寄存器到输出端口。路径2不仅包括两个寄存器之间的组合逻辑，还包括输出寄存器内部从clk到Q端的延时，即一个信号从被采样到输出。
分析时序就是分析这些延迟路径是否满足寄存器要求，数据从输出寄存器Q端输出后经过组合逻辑变成信号c后到达输入寄存器D端的时刻及信号保持时间是否满足寄存器要求。

![[综合时序.drawio.png]]

上述延迟路径模型的时序图如下：

![[综合时序.drawio 1.png]]

标记1：输出寄存器在时钟上升沿采样开始到Q端输出的延迟，姑且叫b信号
标记2：b信号经过组合逻辑延迟及线延迟到达输入寄存器D端，姑且叫c信号
标记3：输入寄存器要求的*建立时间*
标记4：输入寄存器要求的*保持时间*
标记5：c信号的实际*建立时间*
可以看到实际的建立时间5减去要求的建立时间3的值称为建立时间余量`Setup Timing Slack`，其值为正，说明满足要求
标记7：输出寄存器在时钟上升沿采样开始到Q端输出的延迟。与标记1不同的是，标记7为信号从1到0的采样，标记1为信号从0到1的采样，其延迟时间可能有所不同
标记8：信号经过组合逻辑延迟及线延迟到达输入寄存器D端
标记6：c信号的实际保持时间
可以看到实际的保持时间6减去要求的保持时间4的值成为保持时间余量`Hold Timing Slack`，其值为正，说明满足要求
```
标记5 = 时钟周期p - 标记1 - 标记2
```
标记1大小由寄存器自身决定。标记2中包含两部分，一部分为组合逻辑延迟，通过查询门单元延迟获得，一部分为线延迟，如果当前阶段未进行布局布线，通过线延迟模型进行估算；如果当前阶段已有整体布局布线信息，可使用更精确的线延迟。
```
标记6 = 标记7 + 标记8
```
标记7大小由寄存器自身决定。标记8与标记2计算方式相同。


时序约束用的是**sdc**语法，可以理解为TCL语言的基础上增加的一组专门用于时序约束的函数。时序约束语句可以直接写到综合环境脚本中，但一般的做法是单独新建一个文件并将时序约束语句放进去，以sdc为扩展名。在综合环境脚本中直接使用source命令将其读入。选项-v的意思是Verbose即啰嗦的，如果工具有信息需要报告，则尽管报告出来，不需要缩减
```tcl
source -v timing.sdc
```
